---
title: 事件循环，宏任务与微任务
date: "2022-02-22T23:46:37.121Z"
category: "js"
---

JavaScript是一个单线程的脚本语言，所以在一行代码执行的过程中，必然不会存在同时执行的另一行代码。

如果有些代码执行了大量的计算，比方在前端破解密码之类的操作，就会导致后续代码一直在等待，页面处于假死状态，因为前边的代码没有执行完。

所以如果所有代码都是同步执行的，对于一些请求难道要一直循环代码去判断是否拿到了返回结果么，于是就有异步事件的概念。注册一个回调函数，比如说发一个网络请求，我们告诉主程序等到接收到数据后通知我，然后我们就可以去做其他事情了。

然后在异步完成后，会通知我们，但是此时可能程序正在做其他事情，所以即使异步完成了也要在一旁等待，等到程序空闲下来才有时间去看哪些异步已经完成了，可以去执行。

#### 微任务和宏任务的区别
多个宏任务合在一起可以认为有一个任务队列在这，任务队列中的都是已经完成的异步操作，在当前的微任务没有执行完成时，是不会执行下一个宏任务的。

#### 宏任务
- setTimeout
- setInterval
- requestAnimationFrame
- I/O
  
#### 微任务
- Promise.then catch finally
- mutationObserver
  
#### 什么是事件循环
  JavaScipt代码执行的过程中，除了依靠函数调用栈来确定函数的执行顺序外，还依靠任务队列来确定代码执行，整个执行过程称为事件循环过程。一个线程中，事件循环是唯一的，但是任务队列可以拥有多个。任务队列又分为宏任务与微任务。
